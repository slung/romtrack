<!DOCTYPE html>
<html>
	<head>
		<title>Tracks</title>
		
		<!-- Icon -->
		<link rel="icon" href="images/favicon.ico" />
		
		<!-- Style -->
		<link rel="stylesheet" type="text/css" href="style/main.css">
	    <link rel="stylesheet" type="text/css" href="style/grids-min.css">
	    <link rel="stylesheet" type="text/css" href="style/cssreset-min.css">
	    
	    <!-- Google Maps -->
<!--    	<script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.3&sensor=false&language=en"></script>-->
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=geometry&sensor=true"></script>
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
	    
	    
	    <script type="text/javascript" src="libs/jquery-1.7.2.min.js"></script>
	    <script type="text/javascript" src="libs/js.class.js"></script>
		<script type="text/javascript" src="libs/romtracks.jquery.js"></script>
		<script type="text/javascript" src="libs/romtracks.js"></script>
		<script type="text/javascript" src="libs/mustache.js"></script>
		<script type="text/javascript" src="libs/jsonp.js"></script>
		<script type="text/javascript" src="libs/romtracks.helpers.js"></script>
        <script type="text/javascript" src="libs/infobox.js"></script>
        <script type="text/javascript" src="libs/markerclusterer.js"></script>
        <script type="text/javascript" src="libs/d3.js"></script>
	    
		<!-- Font -->
	    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
		
		<!-- Script -->
		<script>
	
			(function( $j )
			{
                google.load("visualization", "1", {packages:["corechart"]});
				
                $j(document).ready( function(){
                    
					/** App **/
					var app = new TRACKS.App({
						state: TRACKS.App.States.DEFAULT,
						views: [
							/*
							 * Search View
							 */
							new TRACKS.SearchView({
                                searchRadius: 40,
								container: TRACKS.one("#search"),
								hideOnStates: [],
								templates: {
									main: $j.trim( TRACKS.one("#search-tpl").innerHTML ),
                                    suggestions: $j.trim( TRACKS.one("#suggestions-tpl").innerHTML )
								}
							}),
							/*
							 * Map View
							 */
							new TRACKS.MapView({
								container: TRACKS.one("#map"),
								renderContainer: TRACKS.one("#map"),
								hideOnStates: [],
								zoom: 3,
								templates: {
                                    tooltipTemplate: $j.trim( TRACKS.one("#tooltip-tpl").innerHTML )
								}	
							}),
                            /*
							 * List View
							 */
							new TRACKS.ListView({
								container: TRACKS.one("#list"),
								renderContainer: TRACKS.one("#list #container"),
								hideOnStates: [],
								templates: {
                                    main: $j.trim( TRACKS.one("#list-tpl").innerHTML )
								}	
							}),
                            /*
							 * Elevation Profile view
							 */
							new TRACKS.ElevationProfileView({
								container: TRACKS.one("#elevation-profile"),
								renderContainer: TRACKS.one("#elevation-profile #container"),
								hideOnStates: [TRACKS.App.States.DEFAULT, TRACKS.App.States.SEARCH],
								templates: {
                                    main: $j.trim( TRACKS.one("#elevation-profile-tpl").innerHTML )
								}	
							})
						]
					});
	
					app.start();
					
					//GeolocateUser
					TRACKS.DataManager.getInstance().geolocateUser();
				});
				
			})(jQuery.noConflict());
			
		</script>	
		
	</head>
	<body>

        <div id="search"></div>
        <div id="list">
            <div id="container"></div>
        </div>
        <div id="elevation-profile">
            <div id="content">
                <img id="elvation-profile-toggle"  src="assets/images/chart.png" width="30px" />
                <div id="container"></div>
            </div>
        </div>
        <div id="map"></div>
		
		<!-- Templates -->
		
		<!-- Search View template -->
		<script id="search-tpl" type="text/template">
            <img src="assets/images/red-search-icon.png" />
			<input id="search-input" class="yui3-u" type="text" placeholder="Find tracks..."/>
            <div id="suggestions"></div>
		</script>
        
        <!-- Search View suggestions template -->
        <script id="suggestions-tpl" type="text/template">
            {{#suggestions}}
                <div class="item">
                    <a id="addr-{{index}}" href="#">{{address}}</a>
                    <div class="separator"></div>
                </div>
            {{/suggestions}}
	   </script>
        
        <!-- Tooltip template -->
        <script id="tooltip-tpl" type="text/template">
            <div class="infoWindow">
                {{#track}}
                    <div id="name">{{name}}</div>
                    <div id="length">Distance: {{length}} km</div>
                {{/track}}
            </div>
            <div class="tail"></div>
		</script>
        
        <!-- List template -->
        <script id="list-tpl" type="text/template">
            <div id="header" class="yui3-g">
                <div id="track-count" class="yui3-u">We found <span id="track-count-number">{{nbTracks}}</span> tracks for you:</div>
            </div>
            <img id="list-toggle" src="assets/images/list.png" width="30px"/>
            <div id="tracks">
                {{#tracks}}
                    <div id="trackitem-{{index}}" class="yui3-g track">
                        <div class="yui3-u">
                            <img src="assets/images/marker.png" />    
                        </div>
                        <div class="yui3-u info">
                            <div id="name">{{name}}</div>
                            <div id="track-parameters" class="yui3-g">
                                <div id="length" class="yui3-u">Distance: {{length}} km</div>
                                <div id="ascent" class="yui3-u">Ascent: {{ascent}} m</div>
                                <div id="descent" class="yui3-u">Descent: {{descent}} m</div>
                            </div>
                            <div id="track-details">See track details</div>
                        </div>
                    </div>
                {{/tracks}}
            </div>
		</script>
		
        <!-- Elevation profile template -->
        <script id="elevation-profile-tpl" type="text/template">
            
		</script>
	</body>
</html>