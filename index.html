<!DOCTYPE html>
<html>
	<head>
		<title>Tracks</title>
		
		<!-- Icon -->
		<link rel="icon" href="images/favicon.ico" />
		
		<!-- Style -->
		<link rel="stylesheet" type="text/css" href="style/main.css">
	    <link rel="stylesheet" type="text/css" href="style/grids-min.css">
	    <link rel="stylesheet" type="text/css" href="style/cssreset-min.css">
        <link rel="stylesheet" href="style/jquery.mCustomScrollbar.min.css" />
	    
	    <!-- Google Maps -->
<!--    	<script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.3&sensor=false&language=en"></script>-->
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=geometry&sensor=true"></script>
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
	    
	    
	    <script type="text/javascript" src="libs/jquery-1.7.2.min.js"></script>
	    <script type="text/javascript" src="libs/js.class.js"></script>
		<script type="text/javascript" src="libs/romtracks.jquery.js"></script>
		<script type="text/javascript" src="libs/romtracks.js"></script>
		<script type="text/javascript" src="libs/mustache.js"></script>
		<script type="text/javascript" src="libs/jsonp.js"></script>
		<script type="text/javascript" src="libs/romtracks.helpers.js"></script>
        <script type="text/javascript" src="libs/infobox.js"></script>
        <script type="text/javascript" src="libs/markerclusterer.js"></script>
        <script type="text/javascript" src="libs/d3.js"></script>
        <script type="text/javascript" src="libs/jquery.mCustomScrollbar.concat.min.js"></script>
	    
		<!-- Font -->
	    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
		
		<!-- Script -->
		<script>
	
			(function( $j )
			{
                google.load("visualization", "1", {packages:["corechart"]});
				
                $j(document).ready( function(){
                    
					/** App **/
					var app = new TRACKS.App({
						state: TRACKS.App.States.DEFAULT,
						views: [
							/*
							 * Search View
							 */
							new TRACKS.SearchView({
                                searchRadius: 40,
                                countryCode: "ro",
								container: TRACKS.one("#search"),
								hideOnStates: [],
								templates: {
									main: $j.trim( TRACKS.one("#search-tpl").innerHTML ),
                                    suggestions: $j.trim( TRACKS.one("#suggestions-tpl").innerHTML )
								}
							}),
							/*
							 * Map View
							 */
							new TRACKS.MapView({
								container: TRACKS.one("#map"),
								renderContainer: TRACKS.one("#map"),
								hideOnStates: [],
								zoom: 3,
								templates: {
                                    tooltipTemplate: $j.trim( TRACKS.one("#tooltip-tpl").innerHTML )
								}	
							}),
                            /*
							 * List View
							 */
							new TRACKS.ListView({
								container: TRACKS.one("#list"),
								renderContainer: TRACKS.one("#list #container"),
								hideOnStates: [],
                                noTracksMsg: "Din păcate nu am găsit trasee în jurul locației căutate :(",
								templates: {
                                    main: $j.trim( TRACKS.one("#list-tpl").innerHTML ),
                                    empty: $j.trim( TRACKS.one("#empty-list-tpl").innerHTML )
								},
                                onReady: function () {
                                    $j("#list #tracks").mCustomScrollbar({
                                        theme: "minimal-dark"
                                    });
                                }
							}),
                            /*
							 * Elevation Profile view
							 */
							new TRACKS.ElevationProfileView({
								container: TRACKS.one("#elevation-profile"),
								renderContainer: TRACKS.one("#elevation-profile #container"),
								hideOnStates: [TRACKS.App.States.DEFAULT, TRACKS.App.States.SEARCH],
                                xAxisName: "Distanță (km)",
                                yAxisName: "Altitudine (m)",
								templates: {
                                    main: $j.trim( TRACKS.one("#elevation-profile-tpl").innerHTML )
								}	
							})
						],
                        appReady: function () {
                            TRACKS.dispatcher.onMessage("tracksInitiated", function () {
                                //GeolocateUser
                                TRACKS.DataManager.getInstance().geolocateUser();
                            });
                        }
					});
	
					app.start();
		
				});
				
			})(jQuery.noConflict());
			
		</script>	
		
	</head>
	<body>

        <div id="search"></div>
        <div id="list">
            <div id="container"></div>
        </div>
        <div id="elevation-profile">
            <div id="content">
                <img id="elvation-profile-toggle"  src="assets/images/chart.png" width="30px" />
                <div id="container"></div>
            </div>
        </div>
        <div id="map"></div>
		
		<!-- Templates -->
		
		<!-- Search View template -->
		<script id="search-tpl" type="text/template">
            <img src="assets/images/red-search-icon.png" />
			<input id="search-input" class="yui3-u" type="text" placeholder="Caută trasee în jurul unei locații..."/>
            <div id="suggestions"></div>
		</script>
        
        <!-- Search View suggestions template -->
        <script id="suggestions-tpl" type="text/template">
            {{#suggestions}}
                <div class="item">
                    <a id="addr-{{index}}" href="#">{{address}}</a>
                    <div class="separator"></div>
                </div>
            {{/suggestions}}
	   </script>
        
        <!-- Tooltip template -->
        <script id="tooltip-tpl" type="text/template">
            <div class="infoWindow yui3-g">
                <img class="yui3-u" src={{track.preview}} width="50px" height="50px"/>
                <div id="details" class="yui3-u">
                    <div id="name">{{track.name}}</div>
                    <div id="length"><b>Lungime:</b> {{track.length}} km</div>
                    <div id="ascent"><b>Urcare:</b> {{track.ascent}} m</div>
                    <div id="descent"><b>Coborâre:</b> {{track.descent}} m</div>
                    {{#fullDetails}}
                        <div id="article"><a href={{track.article}} target="_blank">Citește articolul</a></div>
                        <div id="download"><a href={{track.url}} target="_blank">Descarcă traseul (GPX)</a></div>
                    {{/fullDetails}}
                </div>
            </div>
            <div class="tail"></div>
		</script>
        
        <!-- List template -->
        <script id="list-tpl" type="text/template">
            <div id="header" class="yui3-g">
                <img id="all-tracks" width="16px" title="Vedeți toate traseele" src="assets/images/refresh.png" />
                <div id="track-count" class="yui3-u">Am găsit <span id="track-count-number">{{nbTracks}}</span> trasee:</div>
            </div>
            <img id="list-toggle" src="assets/images/list.png" width="30px"/>
            <div id="tracks">
                {{#tracks}}
                    <div id="trackitem-{{index}}" class="yui3-g track">
                        <div class="yui3-u">
                            <img id="preview" src={{preview}} width="60px" height="30px"/>    
                        </div>
                        <div class="yui3-u info">
                            <div id="name">{{name}}</div>
                            <div id="track-parameters" style="display: none">
                                <div id="length"><b>Lungime:</b> {{length}} km</div>
                                <div id="ascent"><b>Urcare:</b> {{ascent}} m</div>
                                <div id="descent"><b>Coborâre:</b> {{descent}} m</div>
                                <div id="article"><a href={{article}} target="_blank">Citește articolul</a></div>
                                <div id="download"><a href={{url}} target="_blank">Descarcă traseul (GPX)</a></div>
                            </div>
                        </div>
                    </div>
                {{/tracks}}
            </div>
		</script>
        
        <script id="empty-list-tpl" type="text/template">
            <img id="list-toggle" src="assets/images/list.png" width="30px"/>
            {{#message}}
                <div id="message">{{message}}</div>
                <div id="actions">
                    <span id="search" class="link">Căutați altă locație</span> sau <span id="all-tracks" class="link">vedeți toate traseele.</span>
                </div>
            {{/message}}
		</script>
		
        <!-- Elevation profile template -->
        <script id="elevation-profile-tpl" type="text/template">
            
		</script>
	</body>
</html>