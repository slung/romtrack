<!DOCTYPE html>
<html>
	<head>
		<title>Tracks</title>
		
		<!-- Icon -->
		<link rel="icon" href="images/favicon.ico" />
		
		<!-- Style -->
		<link rel="stylesheet" type="text/css" href="style/main.css">
	    <link rel="stylesheet" type="text/css" href="style/grids-min.css">
	    <link rel="stylesheet" type="text/css" href="style/cssreset-min.css">
	    
	    <!-- Google Maps -->
    	<script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.3&sensor=false&language=en"></script>
	    
	    
	    <script type="text/javascript" src="libs/jquery-1.7.2.min.js"></script>
	    <script type="text/javascript" src="libs/js.class.js"></script>
		<script type="text/javascript" src="libs/romtracks.jquery.js"></script>
		<script type="text/javascript" src="libs/romtracks.js"></script>
		<script type="text/javascript" src="libs/mustache.js"></script>
		<script type="text/javascript" src="libs/jsonp.js"></script>
		<script type="text/javascript" src="libs/romtracks.helpers.js"></script>
        <script type="text/javascript" src="libs/infobox.js"></script>
        <script type="text/javascript" src="libs/markerclusterer.js"></script>
	    
		<!-- Font -->
	    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
		
		<!-- Script -->
		<script>
	
			(function( $j )
			{
				$j(document).ready( function(){
					
					/** App **/
					var app = new TRACKS.App({
						state: TRACKS.App.States.DEFAULT,
						views: [
							/*
							 * Search View
							 */
							new TRACKS.SearchView({
                                searchRadius: 40,
								container: TRACKS.one("#search"),
								hideOnStates: [ ],
								templates: {
									main: $j.trim( TRACKS.one("#search-tpl").innerHTML ),
                                    suggestions: $j.trim( TRACKS.one("#suggestions-tpl").innerHTML )
								}
							}),
							/*
							 * Map View
							 */
							new TRACKS.MapView({
								container: TRACKS.one("#map"),
								renderContainer: TRACKS.one("#map"),
								hideOnStates: [],
								zoom: 3,
								templates: {
                                    tooltipTemplate: $j.trim( TRACKS.one("#tooltip-tpl").innerHTML )
								}	
							})
						]
					});
	
					app.start();
					
					//GeolocateUser
					TRACKS.DataManager.getInstance().geolocateUser();
				});
				
			})(jQuery.noConflict());
			
		</script>	
		
	</head>
	<body>

        <div id="search"></div>
        <div id="map"></div>
		
		<!-- Templates -->
		
		<!-- Search View template -->
		<script id="search-tpl" type="text/template">
            <img src="assets/images/red-search-icon.png" width="30px"/>
			<input id="search-input" class="yui3-u" type="text" placeholder="Find tracks..."/>
            <div id="suggestions"></div>
		</script>
        
        <!-- Search View suggestions template -->
        <script id="suggestions-tpl" type="text/template">
            {{#suggestions}}
                <div class="item">
                    <a id="addr-{{index}}" href="#">{{address}}</a>
                    <div class="separator"></div>
                </div>
            {{/suggestions}}
	   </script>
        
        <!-- Tooltip template -->
        <script id="tooltip-tpl" type="text/template">
            <div class="infoWindow">
                {{#track}}{{name}}{{/track}}
            </div>
            <div class="tail"></div>
		</script>
		
	</body>
</html>